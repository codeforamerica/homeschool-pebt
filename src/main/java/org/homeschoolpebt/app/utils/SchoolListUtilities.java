package org.homeschoolpebt.app.utils;

import com.fasterxml.jackson.core.JsonProcessingException;
import com.fasterxml.jackson.databind.JsonNode;
import com.fasterxml.jackson.databind.ObjectMapper;
import org.springframework.stereotype.Component;

import java.util.HashSet;
import java.util.List;
import java.util.Set;

@Component
public class SchoolListUtilities {
  public static boolean allCepSchools(List<String> cdsCodes) {
    try {
      var normalizedCdsCodes = cdsCodes.stream().map(Long::parseLong).toList();
      return cdsCodesForCepSchools().containsAll(normalizedCdsCodes);
    } catch (NumberFormatException e) {
      return false;
    }
  }

  // TODO: Can we cache this processing somehow - make this a singleton or something?
  public static Set<Long> cdsCodesForCepSchools() {
    var cdsCodesForCepSchools = new HashSet<Long>();
    try {
      JsonNode cdsCodes = (new ObjectMapper()).readTree(CEP_SCHOOLS);
      for (var cdsCode : cdsCodes) {
        cdsCodesForCepSchools.add(cdsCode.asLong());
      }

      return cdsCodesForCepSchools;
    } catch (JsonProcessingException e) {
      throw new RuntimeException(e);
    }
  }


  public static final String CEP_SCHOOLS = "[1100170112607,1100176001788,1100170123968,1100170124172,1100170125567,1100170129403,1100170130625,1100170131581,1100170137448,1100170138867,1100176002000,1611190106401,1611190111765,1611190122085,1611190130229,1611190130609,1611190132142,1611190134304,1611196090013,1611196090021,1611196090039,1611196090047,1611196090054,1611196090112,1611196090120,1611196100374,1611196110779,1611196979140,1611190139220,1611270130450,1611276090146,1611276090161,1611276095376,1611276116222,1611430131177,1611430134924,1611436056857,1611436056865,1611436090187,1611436090195,1611436090211,1611436090252,1611436090278,1611436090286,1611436090294,1611436090302,1611436090310,1611436090328,1611436097729,1611436105316,1316090131755,1316170131763,1611500130047,1611500132225,1611500135533,1611506090351,1611506090369,1611506090385,1611506090393,1611506090401,1611506090419,1611506090435,1611506090468,1611506090484,1611506097653,1611506113005,1750930138164,1750930114579,1750930123935,1750930125930,1750930131615,1750930132704,1750930136929,1750930138453,1750936001374,1750936001390,1750936001424,1750936066484,1750936118038,1611680132746,1611686090492,1611760127233,1611760130435,1611760130534,1611760128298,1611760130062,1611760130138,1611760134270,1611760134452,1611760135244,1611760138693,1611766000541,1611766000558,1611766000566,1611766000590,1611766000624,1611766000640,1611766000665,1611766000673,1611766000681,1611766000715,1611766000723,1611766000749,1611766000756,1611766000764,1611766000798,1611766000806,1611766000830,1611766000848,1611766056873,1611766056881,1611766056907,1611766056915,1611766056923,1611766066468,1611766089320,1611766089619,1611766090526,1611766090534,1611766090542,1611766090559,1611766104723,1611766106983,1611766111330,1611760138982,1611920108670,1611920111815,1611920127696,1611920127944,1611920133009,1611920133629,1611920135319,1611920137646,1611920138339,1611926000905,1611926000913,1611926000921,1611926000947,1611926000962,1611926000988,1611926000996,1611926001044,1611926001051,1611926001093,1611926001101,1611926001127,1611926001135,1611926001176,1611926001192,1611926056931,1611926056949,1611926056956,1611926056972,1611926066476,1611926090583,1611926104566,1611926113815,1612000130393,1612000132670,1612000133397,1612000134536,1612000135376,1612006001234,1612006001242,1612006001259,1612006001283,1612006001291,1612006001317,1612006001341,1612006071906,1612006085773,1612006089338,1612006097661,1612006110332,1612006117543,1612186001358,1612420110460,1612420134668,1612426001572,1612426001606,1612426001622,1612426068266,1612426097679,1612426101604,1612426115505,1612426115554,1612426118525,1612427077548,1612340130484,1612340130054,1612340135426,1612346001440,1612346001481,1612346001499,1612346001507,1612346001523,1612346001531,1612346102917,1612590100065,1612590102988,1612590108944,1612590100792,1612590110247,1612590112813,1612590114363,1612590115014,1612590115204,1612590130179,1612590130575,1612590130633,1612590106906,1612596114011,1612596118616,1612590109819,1612590110189,1612590110239,1612590110254,1612590111476,1612590111856,1612590112763,1612590112789,1612590112797,1612590114868,1612590115238,1612590115584,1612590115592,1612590115600,1612590115618,1612590115626,1612590115667,1612590118224,1612590118653,1612590119859,1612590121228,1612590125161,1612590125716,1612590126748,1612590128413,1612590129635,1612590129932,1612590130146,1612590130617,1612590130666,1612590130732,1612590132514,1612590132688,1612590134015,1612590135905,1612590136051,1612590137943,1612593030772,1612596001630,1612596001648,1612596001655,1612596001663,1612596001689,1612596001697,1612596001713,1612596001739,1612596001754,1612596001812,1612596001820,1612596001838,1612596001846,1612596001853,1612596001879,1612596001903,1612596001911,1612596001929,1612596001945,1612596001994,1612596002018,1612596002042,1612596002059,1612596002075,1612596002083,1612596002109,1612596002117,1612596002125,1612596002141,1612596002174,1612596002182,1612596002190,1612596002216,1612596002273,1612596056998,1612596057004,1612596057020,1612596057046,1612596057061,1612596057079,1612596057087,1612596057095,1612596066450,1612596072235,1612596096523,1612596111660,1612596113807,1612596117568,1612596117972,1612596118608,1612596118640,1612596118657,1612596140131,1612596154736,1612590100701,1751010130096,1751010130252,1751010130583,1751016001366,1751016001416,1751016002315,1751016002323,1751016002349,1751016002356,1751016066500,1751016089361,1751016108971,1751016114318,1751016117592,1751016117600,1612910134528,1612910137588,1612916002372,1612916002398,1612916002414,1612916002422,1612916002430,1612916002448,1612916002455,1612916002463,1612916057111,1612916066518,1613090101212,1613090111799,1613090114421,1613090130849,1613090137745,1613090137810,1613096002505,1613096002513,1613096002521,1613096002539,1613096002547,1613096002554,1613096002562,1613096002604,1613096002612,1613096002620,1613096002653,1613096002703,1613097035512,1771800138289,1751196002711,2613336002794,3100330330068,3739816002877,3739810330019,3739810330753,3739810334755,3739816002810,3739816002828,3739816002844,3739816002851,3739816002869,3739816107387,3739816107395,4613826002919,4614080430827,4614086002943,4614086002950,4100410430090,4100410114991,4100410129817,4614240110551,4614240111039,4614240118042,4614240120394,4614240121475,4614240123810,4614240123976,4614240430199,4614240431502,4614240431676,4614240437558,4614246002968,4614246002976,4614246003008,4614246003024,4614246003032,4614246003040,4614246003073,4614246003081,4614246003099,4614246003107,4614246057129,4614246057137,4614246109722,4614246111116,4614246113773,4614246116610,4614246119523,4614320433201,4614326003115,4614326105761,4614576003131,4755070433946,4755070433953,4755076003156,4755076003164,4755076003172,4614996003198,4615070110072,4615070121509,4615070129577,4615076003230,4615076003255,4615076003263,4615076003271,4615076094957,4615150430017,4615150430140,4615150434803,4615150435602,4615150437566,4615236115034,4615230110510,4615236003289,4615236003297,4615236089080,4615316003321,4615310110338,4615310139329,4615310432856,4615310437350,4615316003339,4615316105522,4615316112585,4615316112999,4615316113526,4615316113765,4733796002927,4615490102327,4615496003354,4615496003362,4615496003370,4615496121016,4615490141341,5615560530014,5615560532507,5100586077150,5100580530048,5100589010745,5615640530022,5615640531509,5615646003404,5615646003438,5615646003446,5615646003453,5615646105431,5615646108518,5615726003388,5615726003461,5615806003396,5615806088975,5615806111884,6100660630111,6100660136580,6615980630012,6615980630046,6615980631259,6615986003495,6615986057152,6616060133223,6616060634758,6616066003503,6616140630087,6616140635250,6616146003511,6616146003537,6616146103576,6616220118729,6616220630038,6616220637504,6616226003552,7616300730283,7616300731125,7616300733725,7616300734244,7616480100461,7616480100479,7616480106583,7616480110494,7616480137430,7616480113761,7616480115063,7616480117218,7616480730101,7616480730259,7616480730465,7616480730861,7616486003578,7616486003594,7616486003602,7616486003610,7616486003628,7616486003636,7616486057178,7616486061154,7616486084941,7616486108989,7616486110514,7616486113104,7616486115380,7616486115703,7616486117501,7616487101801,7616550102376,7616550108019,7616550110528,7616550127464,7616556003644,7616556003651,7616556070981,7616556109730,7616556112718,7616556117410,7616556119754,7616636003669,7616636101943,7616636119838,7616716003677,7100740107334,7100740107342,7100740114470,7100740120444,7100740129528,7100740129684,7100740134114,7100740137026,7100740730614,7100740731380,7100746077168,7100746118368,7616970737023,7616970737619,7616976003685,7616976003701,7617050133769,7617056003719,7617136003727,7617136003743,7617136003750,7617136003768,7617136003792,7617210107797,7617210730572,7617210730457,7617210733980,7617210733998,7617390730473,7617390730440,7617390730549,7617396003826,7617396003834,7617396003842,7617396003875,7617396057186,7617540106088,7617540138115,7617540730317,7617540730358,7617540134072,7617540730044,7617540730168,7617540730655,7617540731646,7617540731836,7617540734566,7617540734764,7617540737809,7617546003958,7617546003966,7617546003974,7617546003982,7617546004030,7617546004048,7617546004055,7617546004063,7617546004097,7617546004105,7617546004154,7617546004162,7617546004170,7617546004188,7617546004196,7617546004220,7617546004238,7617546004246,7617546004253,7617546004261,7617546004295,7617546004303,7617546004311,7617546004329,7617546004337,7617546004345,7617546004352,7617546004360,7617546004378,7617546004394,7617546004402,7617546004410,7617546096226,7617546105357,7617546111504,7617546112395,7617546114904,7617540135822,7617620110684,7617620129064,7617620138859,7617626004428,7617626096234,7617626108765,7617626110803,7617626110811,7617626119226,7617880116863,7617880125435,7617880730184,7617880735407,7617886004527,7617886004535,7617886004543,7617886004568,7617886004576,7617886061162,7617886084966,7617886098578,7617886109383,7618040102566,7618040108324,7618040109173,7618040730218,7618040113118,7618040113589,7618040116541,7618040119032,7618040132902,7618040730051,7618040734368,7618040736504,7618040736819,7618046005060,7618046005078,7618046005086,7618046005094,7618046005102,7618046005110,7618046005128,7618046005136,7618046005144,7618046005151,7618046066591,7618046071039,7618046089130,7618046096036,7618046097158,7618046097166,7618046100952,7618046108161,7618046110449,7618046113336,7618046114326,7618046117451,7618046117485,7773540132233,7618120131714,7618126005169,7618126005177,7618126005185,7618126005193,7618126005235,7618126005243,7617960101477,7617960116319,7617960110973,7617960126805,7617960129643,7617960132100,7617960132118,7617960133637,7617960135434,7617960136903,7617960730291,7617960730325,7617960730598,7617960732164,7617960732941,7617960733253,7617960733659,7617960735316,7617960735902,7617960735928,7617966004600,7617966004659,7617966004667,7617966004691,7617966004733,7617966004741,7617966004758,7617966004766,7617966004774,7617966004782,7617966004808,7617966004824,7617966004832,7617966004840,7617966004857,7617966004865,7617966004873,7617966004881,7617966004899,7617966004907,7617966004915,7617966004931,7617966004956,7617966004964,7617966004972,7617966004980,7617966004998,7617966005003,7617966005011,7617966005037,7617966005045,7617966057210,7617966057228,7617966057236,7617966057244,7617966061170,7617966097141,7617966099717,7617966112015,7617966114094,7617966119515,7617966120885,8100820106625,8100820830059,8100820830042,8618200137729,8618200833004,8618200836205,8618206005375,8618206005383,8618206005391,8618206005417,8618206005425,8618206005433,8618206005441,8618206005458,8618206113013,9737830121566,9737830930073,9737830930099,9737836005490,9737836005623,9737836110498,9618380100024,9618380107227,9618380137919,9618386005466,9618386005474,9618386096614,9618386107361,9618386110456,9618386112361,9618466005482,9100900123521,9100900136036,9100900930123,9100906069470,9618530930081,9618530930164,9618530932756,9618530934554,9618530936302,9618796005508,9618796109698,9618876005516,9618876110167,9619030110155,9619030930040,9619030937805,9619036005540,9619036005565,9619036005573,9619036095301,9619296005615,9619296106678,9619456005631,9619456112569,9619456114664,9619526005649,9619526005656,9619526005664,9619606005680,9619606107437,9619780101519,9619780108258,9619786005706,9619786005714,9619786098693,9619786103527,9619786109441,9619866005722,10619946005730,10620426005797,10755981030543,10755981030535,10755986005813,10739650106476,10739650113993,10739650114751,10739650125682,10739650123943,10739650130690,10739650140509,10739651030386,10739651030626,10739651030790,10739651035112,10739656005789,10739656006654,10739656006662,10739656006910,10739656006936,10739656006944,10739656006951,10739656007389,10739656112023,10739656112775,10739656115521,10739656120521,10739656120539,10621096005839,10621170101949,10621170106419,10621170108142,10621170110270,10621170111153,10621170113548,10621170113555,10621170113563,10621170123869,10621170133314,10621170139766,10621171030196,10621171030501,10621171030683,10621171031004,10621171031053,10621176005847,10621176005854,10621176005862,10621176005870,10621176005888,10621176005904,10621176005912,10621176005920,10621176005938,10621176066617,10621176097026,10621176100408,10621176101190,10621176101984,10621176104624,10621176106660,10621176108088,10621176108096,10621176109235,10621176109243,10621176109912,10621176109920,10621176110258,10621176112742,10621176113575,10621176113583,10621176116313,10621176116321,10621176117550,10621176120083,10621176120091,10621251030113,10621251030477,10621251030873,10621251031376,10621256005961,10621256005979,10621256057269,10621256110209,10621256110217,10621256110225,10621256113849,10738090123950,10738091030121,10738091030147,10738096005995,10738096006001,10738096006019,10621581031954,10621581032150,10621586006027,10621586006043,10621586006050,10621586115190,10101081030899,10101086069488,10101080119628,10101080127514,10101080136291,10101080140186,10101081030337,10101086085112,10621660106740,10621660108100,10621660108118,10621660108555,10621660113811,10621660113829,10621660114553,10621666112619,10621660119339,10621660120964,10621660121533,10621660129338,10621660129700,10621660132134,10621660133942,10621661030279,10621661030287,10621661030295,10621661030584,10621661030642,10621661030675,10621661030717,10621661030840,10621661031632,10621661031897,10621661032309,10621661032507,10621661032911,10621661034214,10621661035831,10621666006068,10621666006076,10621666006084,10621666006092,10621666006100,10621666006118,10621666006126,10621666006142,10621666006159,10621666006183,10621666006191,10621666006217,10621666006225,10621666006233,10621666006258,10621666006266,10621666006274,10621666006282,10621666006290,10621666006308,10621666006316,10621666006324,10621666006332,10621666006357,10621666006365,10621666006373,10621666006381,10621666006407,10621666006415,10621666006423,10621666006431,10621666006449,10621666006456,10621666006464,10621666006472,10621666006480,10621666006514,10621666006522,10621666006530,10621666006548,10621666006555,10621666006563,10621666006571,10621666006589,10621666006597]";
}
